import { useState, useEffect } from 'react';
import { Link, useLocation } from 'react-router-dom';
import './Nav.css';

const Nav = () => {
  const [isScrolled, setIsScrolled] = useState(false);
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
  const location = useLocation();

  useEffect(() => {
    const handleScroll = () => {
      setIsScrolled(window.scrollY > 50);
    };

    window.addEventListener('scroll', handleScroll, { passive: true });
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  // Close mobile menu when route changes
  useEffect(() => {
    setIsMobileMenuOpen(false);
  }, [location]);

  const navLinks = [
    { name: 'Projects', path: '/projects' },
    { name: 'Studio', path: '/about' },
    { name: 'Contact', path: '/contact' },
  ];

  const isActive = (path) => {
    // Match exact path or section (e.g., /projects matches /projects/:id)
    if (path === '/projects') {
      return location.pathname === '/projects' || location.pathname.startsWith('/projects/');
    }
    return location.pathname === path;
  };

  return (
    <>
      {/* Main Navigation Bar */}
      <nav
        className={`fixed top-0 left-0 right-0 z-50 bg-white transition-all duration-500 ease-in-out ${
          isScrolled ? 'py-4' : 'py-5'
        }`}
      >
        <div className="max-w-screen-2xl mx-auto px-8 md:px-16 lg:px-20 2xl:px-24 3xl:px-32 4xl:px-40 flex items-center justify-between">
          {/* Logo */}
          <Link
            to="/"
            className="nav-logo flex items-center gap-3 2xl:gap-4 3xl:gap-5 4xl:gap-6 text-gray-900 hover:text-gray-700 transition-colors"
          >
            <svg 
              viewBox="0 0 1024 912" 
              className={`transition-all duration-500 ${isScrolled ? 'w-8 h-7 2xl:w-9 2xl:h-8 3xl:w-10 3xl:h-9 4xl:w-12 4xl:h-11' : 'w-10 h-9 2xl:w-12 2xl:h-11 3xl:w-14 3xl:h-13 4xl:w-16 4xl:h-15'}`}
              xmlns="http://www.w3.org/2000/svg"
            >
              <path 
                d="M470.999939,848.324341 C359.668121,848.321960 248.836304,848.344116 138.004547,848.271423 C128.692078,848.265320 119.381805,847.552917 110.066765,847.315491 C107.101990,847.239868 105.884369,846.000183 105.849358,843.091187 C105.446472,809.620483 104.354752,776.166931 105.432617,742.671997 C106.096451,722.043640 105.990730,701.368408 105.218285,680.705688 C104.620316,664.710083 106.542313,648.802185 109.764961,633.162170 C116.737885,599.321289 130.452713,568.311035 152.975693,542.056152 C175.875153,515.362488 202.307388,492.634583 233.688217,475.883301 C264.074310,459.662994 295.882874,446.979340 328.143707,435.214783 C376.513489,417.575684 426.007141,403.403320 474.903687,387.392395 C493.422333,381.328522 511.901825,374.955658 527.798889,363.075562 C532.368530,359.660645 536.498718,355.814514 539.756897,351.107208 C546.553406,341.287903 546.706726,331.213867 540.076843,321.258179 C532.425598,309.768829 521.280212,302.440460 509.246948,296.490509 C486.720093,285.351898 462.501984,280.208252 437.727905,277.316925 C392.217072,272.005585 346.529175,274.728760 300.911438,274.460205 C284.735962,274.364960 268.600189,273.861053 252.526550,272.141541 C245.555435,271.395782 238.746002,269.513458 232.472641,266.311951 C218.978256,259.425323 215.631668,246.045593 224.190140,233.608856 C232.011169,222.243713 243.039505,214.360031 254.221985,206.796738 C280.797241,188.822571 309.297882,174.308228 338.303070,160.742889 C365.780365,147.892105 393.737946,136.152069 422.307281,125.989258 C441.278015,119.240906 460.346863,112.447472 479.849609,107.594193 C506.309570,101.009605 533.178406,96.014503 559.961060,90.795326 C586.426086,85.638039 613.191711,82.369835 639.930542,78.941505 C671.452881,74.899879 703.095764,72.637573 734.786072,70.325966 C783.741821,66.754944 832.686218,68.517899 881.633789,67.928116 C885.632080,67.879944 889.630371,67.826706 893.628174,67.750381 C900.078857,67.627228 903.322266,70.539955 903.382202,76.964180 C903.467712,86.129143 903.289185,95.296204 903.289001,104.462372 C903.284180,343.292328 903.287048,582.122253 903.295288,820.952209 C903.295471,826.450317 903.451294,831.949280 903.395935,837.446411 C903.316528,845.333862 900.267883,848.327759 892.490662,848.331482 C882.157471,848.336487 871.824341,848.318604 861.491150,848.318665 C731.494080,848.319702 601.497009,848.322021 470.999939,848.324341 M478.179779,216.117050 C495.871826,218.094391 513.579590,219.941238 531.252441,222.077866 C562.349915,225.837524 593.098389,231.620636 623.562134,238.850647 C654.985352,246.308365 686.558167,253.270554 716.888428,264.694000 C732.232117,270.472961 746.932556,277.441040 760.025208,287.506409 C765.364990,291.611603 769.972778,296.384705 773.941284,301.768585 C785.895325,317.985901 784.978088,333.149200 771.084717,347.680878 C757.553162,361.834198 740.455322,370.507874 722.912598,378.357727 C699.617432,388.781738 675.443298,396.873901 651.176758,404.662262 C622.171570,413.971436 593.453918,424.204102 563.775940,431.349030 C521.206543,441.597473 478.800293,452.562256 436.730621,464.646820 C384.666901,479.602173 333.982391,498.535431 284.382019,520.427734 C257.322906,532.370911 230.910629,545.316589 206.916214,562.720703 C185.550491,578.218079 166.791000,596.126465 154.217117,619.877075 C134.910599,656.344971 123.710121,695.194092 121.762840,736.254822 C120.311821,766.851013 121.267426,797.560425 121.087158,828.219055 C121.066895,831.666992 122.038261,833.209290 125.929245,833.323303 C150.084747,834.031677 174.229492,833.101135 198.378357,833.128540 C386.372650,833.341858 574.367615,832.589905 762.361511,833.540955 C775.022034,833.604980 787.697876,832.855896 800.343323,833.243652 C827.498840,834.076294 854.651733,832.998047 881.799866,833.594299 C885.880249,833.683899 888.135864,832.429504 887.809509,827.909241 C887.618408,825.262939 887.968628,822.581970 887.969055,819.916626 C887.992432,686.252258 888.049011,552.587952 888.003601,418.923584 C887.966248,309.092896 887.798645,199.262253 887.735107,89.431572 C887.733032,85.794800 887.799377,83.103218 882.681946,83.138985 C843.041565,83.416039 803.412720,83.019592 763.807800,85.955597 C737.248596,87.924500 710.609680,88.913368 684.178833,92.346199 C665.043884,94.831436 645.704224,96.046173 626.815186,100.089737 C586.386902,108.744133 546.624268,119.820915 508.003021,134.706879 C479.355652,145.748550 451.511200,158.488052 425.415436,174.804459 C421.996918,176.941895 418.887024,179.441101 416.664032,182.874741 C412.092865,189.935394 413.513977,199.019791 420.161316,203.276917 C423.933105,205.692459 428.014282,207.924683 432.483826,208.596634 C447.457214,210.847733 462.155151,214.778076 478.179779,216.117050 z" 
                fill="currentColor"
              />
            </svg>
            <span className="text-base 2xl:text-lg 3xl:text-xl 4xl:text-2xl font-normal tracking-wide">
              Studio S
              <span className="text-accent-red" style={{ color: '#DC2626' }}>
                .
              </span>
              Path
            </span>
          </Link>

          {/* Desktop Navigation */}
          <div className="hidden md:flex items-center gap-12 2xl:gap-14 3xl:gap-16 4xl:gap-20">
            {navLinks.map((link) => (
              <Link
                key={link.path}
                to={link.path}
                className={`relative text-sm 2xl:text-base 3xl:text-lg 4xl:text-xl font-normal tracking-wide text-gray-900 transition-colors hover:text-gray-700 ${
                  isActive(link.path) ? 'nav-link-active' : 'nav-link'
                }`}
              >
                {link.name}
              </Link>
            ))}
          </div>

          {/* Mobile Menu Icon */}
          <button
            onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
            className="md:hidden text-gray-900 hover:text-gray-700 transition-colors"
            aria-label="Toggle menu"
          >
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              strokeWidth="1.5"
              strokeLinecap="round"
            >
              {isMobileMenuOpen ? (
                <>
                  <line x1="18" y1="6" x2="6" y2="18" />
                  <line x1="6" y1="6" x2="18" y2="18" />
                </>
              ) : (
                <>
                  <line x1="3" y1="12" x2="21" y2="12" />
                  <line x1="3" y1="6" x2="21" y2="6" />
                  <line x1="3" y1="18" x2="21" y2="18" />
                </>
              )}
            </svg>
          </button>
        </div>
      </nav>

      {/* Mobile Menu Overlay */}
      {isMobileMenuOpen && (
        <div
          className="fixed inset-0 z-40 bg-white flex items-center justify-center md:hidden animate-fade-in"
          style={{ paddingTop: '80px' }}
        >
          <nav className="flex flex-col items-center gap-16">
            {navLinks.map((link) => (
              <Link
                key={link.path}
                to={link.path}
                className={`text-2xl font-light tracking-wide text-gray-900 transition-colors hover:text-gray-700 ${
                  isActive(link.path) ? 'mobile-nav-link-active' : ''
                }`}
              >
                {link.name}
              </Link>
            ))}
          </nav>
        </div>
      )}
    </>
  );
};

export default Nav;
